function getFilteredRecords(e,r,t){var i=[];if(r)for(var s=parser.parse(r),a=0;a<e.length;a++)s(e[a])&&i.push(e[a]);else i=e;if(t)return i;for(var o=[],a=0;a<i.length;a++)$.merge(o,getLinkedRecords(i[a])),o.push(i[a]);return o.unique()}function getLinkedRecords(e){var r=[];if(e.adminstrators&&$.merge(r,e.administrators),e.host){var t=e.host;r.push(t),t.adminstrators&&$.merge(r,t.administrators),t.interfaces&&$.merge(r,t.interfaces)}return r}function matchFields(e,r){for(var t=new RegExp(r,"i"),i=0;i<e.length;i++)if(t.test(e[i]))return!0;return!1}function matchRecord(e,r,t){var i=[],s=getLinkedRecords(e);if(s.push(e),r)if(r=r.toLowerCase(),filterAliases[r])for(var a=0;a<s.length;a++)$.merge(i,filterAliases[r].getFields(s[a]));else for(var a=0;a<s.length;a++)s[a][r]instanceof Array&&$.merge(i,s[a][r]);else for(var a=0;a<s.length;a++)$.merge(i,filterMap["default"].getFields(s[a]));var o=parseOperand(t);return o?matchFields(i,o)||matchFields(i,t):matchFields(i,t)}function parseOperand(e){var r=parseRate(e,!0);if(r)return formatRate(r);var t=parseSize(e);if(t)return formatSize(t);var i=parseSpeed(e);return i?formatSpeed(i):null}var filterMap={address:{getFields:function(e){return getAddresses(e)}},administrator:{getFields:function(e){var r=[];return hasField(e,"person-name")&&r.push(e["person-name"][0]),$.merge(r,filterMap.email.getFields(e)),$.merge(r,filterMap.organization.getFields(e)),r}},city:{getFields:function(e){return hasField(e,"location-city")?[e["location-city"][0]]:[]}},community:{getFields:function(e){return hasField(e,"group-communities")?e["group-communities"]:[]}},country:{getFields:function(e){if(hasField(e,"location-country")){var r=e["location-country"][0],t=getCountryString(r);return r!=t?[r,t]:[t]}return[]}},email:{getFields:function(e){return hasField(e,"person-emails")?e["person-emails"]:[]}},hardware:{getFields:function(e){var r=[];return $.merge(r,filterMap.memory.getFields(e)),$.merge(r,filterMap.processor.getFields(e)),$.merge(r,filterMap.nicspeed.getFields(e)),r}},hostname:{getFields:function(e){var r=getHostnames(e);return hasField(e,"group-domains")&&$.merge(r,e["group-domains"]),r}},kernel:{getFields:function(e){return hasField(e,"host-os-kernel")?[e["host-os-kernel"][0]]:[]}},location:{getFields:function(e){var r=[];return $.merge(r,filterMap.site.getFields(e)),$.merge(r,filterMap.city.getFields(e)),$.merge(r,filterMap.state.getFields(e)),$.merge(r,filterMap.country.getFields(e)),$.merge(r,filterMap.zipcode.getFields(e)),r}},memory:{getFields:function(e){if(hasField(e,"host-hardware-memory")){var r=parseSize(e["host-hardware-memory"][0],!0);if(r)return[formatSize(r)]}return[]}},mtu:{getFields:function(e){return hasField(e,"interface-mtu")?[e["interface-mtu"][0]]:[]}},name:{getFields:function(e){var r=[],t=e.type[0];hasField(e,t+"-name")&&$.merge(r,e[t+"-name"]);var i=getTitle(e);return i&&r.push(i),r}},nicspeed:{getFields:function(e){if(hasField(e,"interface-capacity")){var r=parseRate(e["interface-capacity"][0],!0);if(r)return[formatRate(r)]}return[]}},organization:{getFields:function(e){return hasField(e,"person-organization")?[e["person-organization"][0]]:[]}},os:{getFields:function(e){var r=[];return $.merge(r,filterMap.osname.getFields(e)),$.merge(r,filterMap.osversion.getFields(e)),r}},osname:{getFields:function(e){return hasField(e,"host-os-name")?[e["host-os-name"][0]]:[]}},osversion:{getFields:function(e){return hasField(e,"host-os-version")?[e["host-os-version"][0]]:[]}},processor:{getFields:function(e){var r=[];return $.merge(r,filterMap.processorcores.getFields(e)),$.merge(r,filterMap.processorcount.getFields(e)),$.merge(r,filterMap.processorspeed.getFields(e)),r}},processorcores:{getFields:function(e){return hasField(e,"host-hardware-processorcore")?[e["host-hardware-processorcore"][0]]:[]}},processorcount:{getFields:function(e){return hasField(e,"host-hardware-processorcount")?[e["host-hardware-processorcount"][0]]:[]}},processorspeed:{getFields:function(e){if(hasField(e,"host-hardware-processorspeed")){var r=parseSpeed(e["host-hardware-processorspeed"][0],!0);if(r)return[formatSpeed(r)]}return[]}},site:{getFields:function(e){return hasField(e,"location-sitename")?[e["location-sitename"][0]]:[]}},state:{getFields:function(e){if(hasField(e,"location-state")){var r=e["location-state"][0],t=getStateString(r);return r!=t?[r,t]:[t]}return[]}},system:{getFields:function(e){var r=[];return $.merge(r,filterMap.hardware.getFields(e)),$.merge(r,filterMap.kernel.getFields(e)),$.merge(r,filterMap.mtu.getFields(e)),$.merge(r,filterMap.os.getFields(e)),$.merge(r,filterMap.version.getFields(e)),r}},type:{getFields:function(e){var r=[],t=e.type[0];if(r.push(t),hasField(e,t+"-type")){var i=e[t+"-type"][0];r.push(i),hasField(e,i+"-type")&&r.push(e[i+"-type"][0])}return r}},version:{getFields:function(e){return hasField(e,"pshost-toolkitversion")?[e["pshost-toolkitversion"][0]]:hasField(e,"service-version")?[e["service-version"][0]]:[]}},zipcode:{getFields:function(e){return hasField(e,"location-code")?[e["location-code"][0]]:[]}},"default":{getFields:function(e){var r=[];return $.merge(r,filterMap.address.getFields(e)),$.merge(r,filterMap.administrator.getFields(e)),$.merge(r,filterMap.community.getFields(e)),$.merge(r,filterMap.hostname.getFields(e)),$.merge(r,filterMap.location.getFields(e)),$.merge(r,filterMap.system.getFields(e)),$.merge(r,filterMap.type.getFields(e)),r}}},filterAliases={address:filterMap.address,addresses:filterMap.address,admin:filterMap.administrator,admins:filterMap.administrator,administrator:filterMap.administrator,administrators:filterMap.administrator,city:filterMap.city,cities:filterMap.city,cores:filterMap.processorcores,community:filterMap.community,communities:filterMap.community,country:filterMap.country,countries:filterMap.country,cpu:filterMap.processor,cpus:filterMap.processorcount,cpucores:filterMap.processorcores,cpucount:filterMap.processorcount,cpucounts:filterMap.processorcount,cpuspeed:filterMap.processorspeed,cpuspeeds:filterMap.processorspeed,domain:filterMap.hostname,domains:filterMap.hostname,email:filterMap.email,emails:filterMap.email,group:filterMap.community,groups:filterMap.community,hardware:filterMap.hardware,host:filterMap.hostname,hosts:filterMap.hostname,hostname:filterMap.hostname,hostnames:filterMap.hostname,kernel:filterMap.kernel,kernels:filterMap.kernel,kind:filterMap.type,kinds:filterMap.type,location:filterMap.location,locations:filterMap.location,locator:filterMap.address,locators:filterMap.address,mem:filterMap.memory,memory:filterMap.memory,mtu:filterMap.mtu,name:filterMap.name,names:filterMap.name,nicspeed:filterMap.nicspeed,nicspeeds:filterMap.nicspeed,organization:filterMap.organization,organizations:filterMap.organization,os:filterMap.os,osname:filterMap.osname,osnames:filterMap.osnames,osversion:filterMap.osversion,osversions:filterMap.osversion,processor:filterMap.processorcores,processorcores:filterMap.processorcores,processorcount:filterMap.processorcount,processorcounts:filterMap.processorcount,processorspeed:filterMap.processorspeed,processorspeeds:filterMap.processorspeed,site:filterMap.site,sites:filterMap.site,sitename:filterMap.site,sitenames:filterMap.site,software:filterMap.version,speed:filterMap.nicspeed,speeds:filterMap.nicspeed,state:filterMap.state,states:filterMap.state,system:filterMap.system,title:filterMap.name,titles:filterMap.name,toolkitversion:filterMap.version,toolkitversions:filterMap.version,type:filterMap.type,types:filterMap.type,version:filterMap.version,versions:filterMap.version,zipcode:filterMap.zipcode,zipcodes:filterMap.zipcode};